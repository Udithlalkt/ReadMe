import com.example.generated.BatchRenewalRq;
import com.example.generated.BatchRenewalRs;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.core.io.ClassPathResource;
import jakarta.xml.bind.JAXBContext;
import jakarta.xml.bind.Unmarshaller;
import java.io.InputStream;

import static org.junit.jupiter.api.Assertions.*;

@SpringBootTest
public class BatchRenewalProcessorTest {

    @Autowired
    private BatchRenewalProcessor batchRenewalProcessor; // Class containing processRequest()

    @Test
    void processRequest_WithValidXmlRequest_ReturnsValidResponse() throws Exception {
        // 1. Load XML test file from resources
        ClassPathResource resource = new ClassPathResource("requests/batch-renewal-request.xml");
        
        // 2. Unmarshal XML to JAXB object
        BatchRenewalRq request = unmarshalXml(resource.getInputStream(), BatchRenewalRq.class);
        
        // 3. Process the request
        BatchRenewalRs response = batchRenewalProcessor.processRequest(request);
        
        // 4. Assertions
        assertNotNull(response, "Response should not be null");
        assertNotNull(response.getDetails(), "Details should not be null");
        // Add more domain-specific assertions here
    }

    private <T> T unmarshalXml(InputStream xmlStream, Class<T> clazz) throws Exception {
        JAXBContext jaxbContext = JAXBContext.newInstance(clazz);
        Unmarshaller unmarshaller = jaxbContext.createUnmarshaller();
        return clazz.cast(unmarshaller.unmarshal(xmlStream));
    }
}